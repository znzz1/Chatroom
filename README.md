# ChatRoom 聊天室后端

## 简介
ChatRoom 是一个基于 C++20 的高性能聊天室后端，采用事件驱动与多线程并发架构，支持多用户实时通信、房间管理与消息持久化，面向高并发场景优化。

## 技术栈与架构亮点

- **C++20**：主力开发语言，利用现代 C++ 的类型安全与高效特性。
- **epoll + 非阻塞 IO**：Linux 下高性能事件驱动模型，支撑高并发长连接。
- **轻量级线程池**：任务并发调度，提升多核利用率，结构简单高效。
- **MySQL（预处理语句 + 连接池管理）**：预处理语句防 SQL 注入，连接池提升并发访问效率。
- **jsoncpp**：JSON 协议解析与序列化，实现客户端与服务端数据交换。
- **OpenSSL**：密码哈希和加密，提升用户数据安全性。
- **CMake**：跨平台构建，便于依赖管理和工程集成。

## 架构分层示意

```mermaid
graph TD
  Client["客户端"] -->|TCP/JSON| Entry["入口层\n(主程序/协议解析)"]
  Entry --> Net["网络层\n(epoll/Socket管理)"]
  Net --> ThreadPool["线程池\n(并发调度)"]
  Entry --> Service["服务层\n(业务编排/权限校验)"]
  Service --> Dao["DAO层\n(数据访问/ORM)"]
  Dao --> ConnPool["连接池\n(MySQL管理)"]
  ConnPool --> DB["MySQL数据库"]
  Entry --> Utils["工具/通用组件\n(日志/配置/加密)"]

  %% 注释: 各层职责
  %% Entry: 负责协议解析、请求分发
  %% Net: 负责高并发连接管理
  %% ThreadPool: 负责任务并发调度
  %% Service: 负责业务逻辑、权限校验
  %% DAO: 负责数据库操作封装
  %% ConnPool: 负责数据库连接复用与管理
  %% Utils: 提供通用工具支持
```

## 主要特性
- 用户注册、登录、登出
- 用户信息修改（昵称、密码）
- 聊天室房间的创建、删除、修改、查询
- 房间人数上限、房间描述、房间状态管理
- 消息实时发送与接收
- 聊天记录持久化与历史消息拉取
- 管理员与普通用户权限分级

## 未来展望

- **性能优化**
  - 进一步细分锁的粒度，减少临界区，提高多线程并发性能
- **功能完善**
  - 支持离线消息、消息推送、消息撤回、@提醒、文件/图片发送等高级聊天功能
- **前端体验**
  - 开发配套前端 UI，提升用户交互体验